<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Table Extractor</title>
	
</head>
<body>
	<br><br>
	<input id="text1" placeholder="Enter URL">
	<br><br>
	<button onclick="get_table_count()">submit</button><br>
    <h1><span id="ans"></span></h1>
    <input id="text2" placeholder="Enter table number">
    <button onclick="get_excel_format()">submit</button><br>
    <br><br>
    <button onclick="Download()">Download</button><br>
	<br><br>
<script >
    var file_name = '';
	function get_table_count() 
	{
		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
			document.getElementById("ans").innerHTML = "Number of tables in the page: "+this.responseText;
			}
		};
		var url = String(document.getElementById("text1").value);
		xhttp.open("GET", "https://5qkn72nq7a.execute-api.ap-south-1.amazonaws.com/prod/RetrunTableCount?url="+url, true);
		xhttp.send();
	}
    function get_excel_format()
    {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function(){
            if (this.readyState == 4 && this.status == 200) {
                var link = this.responseText;
                console.log(link);
                document.getElementById('text2').innerHTML = link;
                file_name = link;
                console.log(file_name);
            }
        };
        var number = String(document.getElementById("text2").value);
        var url = String(document.getElementById('text1').value);
        xhttp.open("GET", "https://5qkn72nq7a.execute-api.ap-south-1.amazonaws.com/prod/generate_excel_sheet?number="+number+"&"+"url="+url, true);
        xhttp.send();
    }
    function Download(){
        var link = document.createElement('a');
        link.href = file_name;
        console.log(link.href);
        document.body.appendChild(link);
        link.click();
    }
</script>
</body>
</html>